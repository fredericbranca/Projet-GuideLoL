{% extends 'base.html.twig' %}

{% block title %}Guide
{% endblock %}

{% block additional_css %}
	<link rel="stylesheet" href="{{ asset('css/afficher-guide.css') }}">
{% endblock %}

{% block body %}

	<div class="menu">
		<span class="current" id="menu_commentaires">Commentaires</span>
		<span id="menu_guide">Guide</span>
	</div>

	<div id="guide">

		<div id="introduction">

			<h1>
				{{ guide.champion }}
				{{ guide.voie }}
				-
				{{ guide.titre }}</h1>

		</div>

		<div
			class="runes-sorts-inv">

			{# Section Rune #}
			<section id="Runes" class="runes-container">
				{% set nbGroupesRunes = guide.groupeRunes|length %}
				<div id="pagination">
					{% for i in 1..nbGroupesRunes %}
						<span class="page-number {{ i > 1 ? '' : 'current' }}">{{ i }}</span>
					{% endfor %}
				</div>


				{% for groupeRunes in guide.groupeRunes %}

					<div class="groupe-runes groupe" id="groupeRunes{{ loop.index0 }}" data-groupe={{ groupeRunes.ordre }} style="{{ loop.index0 > 0 ? 'display: none;' : 'display: flex;' }}">

						<div>RUNES:
							{{ groupeRunes.titre }}</div>
						{% if groupeRunes.commentaire %}
							<div class="note" title="{{ groupeRunes.commentaire }}">
								<i class="fa-solid fa-pen" style="color: #ffffff;"></i>
								Notes</div>
						{% endif %}

						<div id="arbre">
							{% set primaire = [] %}
							{% set secondaire = [] %}
							{% set bonus = [] %}
							{% for choixRunesPages in groupeRunes.choixRunesPages %}
								{% for choixArbres in choixRunesPages.choixArbres %}
									{% if choixArbres.type is same as("Primaire") %}
										{% for rune in choixArbres.choixRunes %}
											{% set primaire = primaire|merge([rune]) %}
										{% endfor %}
									{% else %}
										{% for rune in choixArbres.choixRunes %}
											{% set secondaire = secondaire|merge([rune]) %}
										{% endfor %}
									{% endif %}
								{% endfor %}
								{% for choixStatistiquesBonus in choixRunesPages.choixStatistiquesBonus %}
									{% set bonus = bonus|merge([choixStatistiquesBonus]) %}
								{% endfor %}
							{% endfor %}

							<div
								id="Primaire">
								{# Tri et affichage des runes primaires #}
								<div class="type-arbre">
									<span class="rune-arbre-titre">{{ primaire[groupeRunes.ordre].runeArbre }}</span>
									<img src="{{ img_url }}/{{ runes_data[primaire[groupeRunes.ordre].runeArbre].icon}}.webp" alt="{{ runes_data[primaire[groupeRunes.ordre].runeArbre].name }}">
								</div>
								{% for type in ['Primary', 'Secondary1', 'Secondary2', 'Secondary3'] %}
									{% for rune in primaire %}
										{% if rune.runeType == type %}
											<div class="choix-rune" title="{{ runes_data[rune.id].shortDesc|striptags|escape('html_attr') }}">
												<img src="{{ img_url }}/{{ runes_data[rune.id].icon }}.webp" alt="{{ runes_data[rune.id].name }}">
												<span class="rune-titre">{{ runes_data[rune.id].name }}</span>
											</div>
										{% endif %}
									{% endfor %}
								{% endfor %}
							</div>

							<div class="rune-2">
								<div
									id="Secondaire">
									{# Tri et affichage des runes secondaires #}
									<div class="type-arbre">
										<span class="rune-arbre-titre">{{ secondaire[groupeRunes.ordre].runeArbre }}</span>
										<img src="{{ img_url }}/{{ runes_data[secondaire[groupeRunes.ordre].runeArbre].icon}}.webp" alt="{{ runes_data[secondaire[groupeRunes.ordre].runeArbre].name }}">
									</div>
									{% for type in ['Secondary1', 'Secondary2', 'Secondary3'] %}
										{% for rune in secondaire %}
											{% if rune.runeType == type %}
												<div class="choix-rune" title="{{ runes_data[rune.id].shortDesc|striptags|escape('html_attr') }}">
													<img src="{{ img_url }}/{{ runes_data[rune.id].icon }}.webp" alt="{{ runes_data[rune.id].name }}">
													<span class="rune-titre">{{ runes_data[rune.id].name }}</span>
												</div>
											{% endif %}
										{% endfor %}
									{% endfor %}
								</div>

								<div
									id="bonus">
									{# Tri et affichage des bonus #}
									{% for i in 1..3 %}
										{% for bonusData in bonus %}
											{% if bonusData.bonusLine == i %}
												<div class="choix-rune">
													<img src="{{ img_url }}/{{ bonusData.icon }}.webp" alt="{{ bonusData.bonusValue }}">
													<span class="rune-titre">{{ bonusData.bonusValue }}</span>
												</div>
											{% endif %}
										{% endfor %}
									{% endfor %}
								</div>
							</div>
						</div>

					</div>
				{% endfor %}

			</section>

			{# Secion Sort d'invocateur #}
			<section id="sortInvocateur">

				<h2>Sort d'invocateur</h2>

				{% for groupeSortsInvocateur in guide.groupeSortsInvocateur %}
					<div id="groupeSortInvocateur">

						<div>Titre :
							{{ groupeSortsInvocateur.titre }}</div>
						<div>Commentaire :
							{{ groupeSortsInvocateur.commentaire }}</div>

						{% for choixSortInvocateur in groupeSortsInvocateur.choixSortInvocateur %}
							<img src="{{ img_url }}/spell/{{ list_sorts_invocateur[choixSortInvocateur.id].image }}.webp" alt="{{ list_sorts_invocateur[choixSortInvocateur.id].name }}">
						{% endfor %}

					</div>
				{% endfor %}

			</section>
		</div>

		{# Secion Item #}

		<section id="item">

			<h2>Item</h2>

			{% for groupeEnsemblesItems in guide.groupeEnsemblesItems %}

				<ul id="ensemble">

					<h3>Ensemble</h3>

					<div>Titre :
						{{ groupeEnsemblesItems.titre }}</div>

					{% for itemsGroups in groupeEnsemblesItems.associationsEnsemblesItemsGroups %}

						<li id="groupeItems">

							<div>Titre :
								{{ itemsGroups.titre }}</div>
							<div>Commentaire :
								{{ itemsGroups.commentaire }}</div>

							{% set ordreItems = itemsGroups.ordreItems|sort %}
							{% set trieItems = {} %}
							{% for id in ordreItems|keys %}
								{% for choixItems in itemsGroups.choixItems %}
									{% if choixItems.id is same as(id) %}
										{% set trieItems = trieItems|merge([choixItems]) %}
									{% endif %}
								{% endfor %}
							{% endfor %}

							{% for choixItems in trieItems %}
								<img style="width: 40px; height: auto;" src="{{ img_url }}/item/{{ list_items[choixItems.id].image }}.webp" alt="{{ list_items[choixItems.id].name }}">
							{% endfor %}

						</li>

					{% endfor %}

				</ul>

			{% endfor %}

		</section>

		{# Sectin compétence #}
		<section id="competence">

			<h2>Compétence</h2>

			{% for groupesCompetences in guide.groupesCompetences %}

				<div id="groupeCompetences">

					<div>Titre :
						{{ groupesCompetences.titre }}</div>
					<div>Commentaire :
						{{ groupesCompetences.commentaire }}</div>

					<div class="competence-passive">
						<img src="{{ img_url }}/passive/{{ champion.passive.image.full }}.webp" alt="{{ champion.passive.name }}">
						Compétence passive :
						{{ champion.passive.name }}
					</div>

					{% for choixCompetencesNiveaux in groupesCompetences.choixCompetencesNiveaux %}

						<div class="competence">
							{% set index = loop.index0 %}

							{% for competence in choixCompetencesNiveaux.competences %}
								<img src="{{ img_url }}/spell/{{ champion.spells[index].image.full }}.webp" alt="{{ champion.spells[index].name }}">

								<div class="niveaux">
									{% for niveau in 1..18 %}
										<div class="case{% if niveau in choixCompetencesNiveaux.niveaux %} active{% endif %}">
											{% if niveau in choixCompetencesNiveaux.niveaux %}
												<span>{{ niveau }}</span>
											{% endif %}
										</div>
									{% endfor %}
								</div>

							{% endfor %}
						</div>

					{% endfor %}

				</div>

			{% endfor %}

		</section>
	</div>

	<div id="commentaire-container">
		{% if evaluations %}
			{% for evaluation in evaluations %}
				<div class="commentaire">
					{{ evaluation.user.pseudo }}
					{{ evaluation.commentaire }}
					{{ evaluation.createdAt|date }}
				</div>
			{% endfor %}
		{% else %}
			<div>Pas de commentaire</div>
		{% endif %}
	</div>

	<script src="{{ asset('js/afficherGuide.js') }}"></script>
{% endblock %}
